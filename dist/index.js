var P="astro-svg-sprite";import m from"node:fs";function q(t){let e="./src/assets/images/sprite";if(!t||t==="")return e;if(typeof t=="string")return t;if(Array.isArray(t)){let r=t.filter(s=>s&&s!=="");if(r.length>0)return r}return e}function H(t){return!t||t===""?"assets/images":t}var w=class{colors={reset:"\x1B[0m",fg:{red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",cyanBold:"\x1B[1m\x1B[36m"}};packageName;constructor(e){this.packageName=e}log(e,r=""){let s=e.join(`
`),n=new Date,a=n.getHours().toString().padStart(2,"0"),o=n.getMinutes().toString().padStart(2,"0"),c=n.getSeconds().toString().padStart(2,"0"),l=`\x1B[2m${a}:${o}:${c}\x1B[22m`;console.log(`${l} %s[${this.packageName}]%s ${s}`,r,r?this.colors.reset:"")}info(...e){this.log(e,this.colors.fg.cyanBold)}success(...e){this.log(e,this.colors.fg.cyanBold)}warn(...e){this.log([`${this.colors.fg.yellow}(!)${this.colors.reset} ${e}`],this.colors.fg.cyanBold)}error(...e){this.log([`${this.colors.fg.red}failed!${this.colors.reset}`,...e],this.colors.fg.cyanBold)}};function A(t){let e=/viewBox="([^"]*)"/,r=/fill="([^"]*)"/,s=t.match(e),n=t.match(r),a=s&&s[0]?s[0]:"",o=n&&n[0]?n[0]:"";return`${a} ${o}`}function T(t){let e="<svg",r="</svg>",s=t.indexOf(e),n=t.indexOf(r);if(s!==-1&&n!==-1){let a=t.indexOf(">",s);return t.slice(a+1,n).trim()}return""}function $(t){return typeof t=="string"?m.readdirSync(t).some(r=>r.endsWith(".svg")):Array.isArray(t)?t.some(e=>m.readdirSync(e).some(s=>s.endsWith(".svg"))):!1}function y(t){return t.includes("<svg")&&t.includes("</svg>")}function v(t){let e=performance.now();t();let r=performance.now();return Math.floor(r-e)}var F=new w(P);var z=[],b=[],S=[];function J(t){m.readdirSync(t).forEach(e=>{if(!e.toLowerCase().endsWith(".svg"))return;let r=m.readFileSync(`${t}/${e}`,"utf-8");y(r)?S.push(`${t}/${e}`):(b.push(`${t}/${e}`),S.push(`${t}/${e}`)),y(r)&&z.push({name:e.replace(/\.svg$/,""),content:r})})}function K(t){typeof t=="string"?J(t):Array.isArray(t)&&t.forEach(e=>J(e))}function N(t){return $(t)&&(typeof t=="string"?K(t):Array.isArray(t)&&t.forEach(e=>K(e))),z}function E(t){let e='<svg xmlns="http://www.w3.org/2000/svg" class="svg-sprite">';return t.forEach(r=>{e+=`
      <symbol class="svg-sprite" id="${r.name}" ${A(r.content)}>
        ${T(r.content)}  
      </symbol>
    `}),e+="</svg>",e}function R(t,e){if(!m.existsSync(t)){let r=t.substr(0,t.lastIndexOf("/"));m.existsSync(r)||m.mkdirSync(r,{recursive:!0}),m.writeFileSync(t,"","utf-8")}m.writeFileSync(t,e,"utf-8")}function k(t){let e=/<circle([^>]*)\/?>/g;return t.replace(e,(s,n)=>{let a=/(\w+)\s*=\s*["']([^"']*)["']/g,o={},c;for(;(c=a.exec(n))!==null;){let[,x,d]=c;o[x]=d}let{cx:l,cy:g,r:i,...u}=o,p=`M${Number(l)-Number(i)},${g}A${i},${i} 0 1,0 ${Number(l)+Number(i)},${g}A${i},${i} 0 1,0 ${Number(l)-Number(i)},${g}`,f=Object.entries(u).map(([x,d])=>`${x}="${d}"`).join(" ");return`<path d="${p}" ${f}></path>`})}function V(t){let e=/<ellipse([^>]*)\/?>/g;return t.replace(e,(s,n)=>{let a=/(\w+)\s*=\s*["']([^"']*)["']/g,o={},c;for(;(c=a.exec(n))!==null;){let[,d,h]=c;o[d]=h}let{cx:l,cy:g,rx:i,ry:u,...p}=o,f=`M${Number(l)-Number(i)},${g}A${i},${u} 0 1,0 ${Number(l)+Number(i)},${g}A${i},${u} 0 1,0 ${Number(l)-Number(i)},${g}`,x=Object.entries(p).map(([d,h])=>`${d}="${h}"`).join(" ");return`<path d="${f}" ${x}></path>`})}function B(t){let e=/<line([^>]*)\/?>/g;return t.replace(e,(s,n)=>{let a=/(\w+)\s*=\s*["']([^"']*)["']/g,o={},c;for(;(c=a.exec(n))!==null;){let[,d,h]=c;o[d]=h}let{x1:l,y1:g,x2:i,y2:u,...p}=o,f=`M ${l},${g} L ${i},${u}`,x=Object.entries(p).map(([d,h])=>`${d}="${h}"`).join(" ");return`<path d="${f}" ${x}></path>`})}function M(t){return t.split(/\s+/).map(e=>Number(e))}function L(t){let e=/<polygon([^>]*)\/?>/g;return t.replace(e,(s,n)=>{let a=/(\w+)\s*=\s*["']([^"']*)["']/g,o={},c;for(;(c=a.exec(n))!==null;){let[,p,f]=c;o[p]=f}let{points:l,...g}=o,i=`M ${M(l).join(" ")} Z`,u=Object.entries(g).map(([p,f])=>`${p}="${f}"`).join(" ");return`<path d="${i}" ${u}></path>`})}function D(t){let e=/<polyline([^>]*)\/?>/g;return t.replace(e,(s,n)=>{let a=/(\w+)\s*=\s*["']([^"']*)["']/g,o={},c;for(;(c=a.exec(n))!==null;){let[,p,f]=c;o[p]=f}let{points:l,...g}=o,i=`M ${M(l).join(" ")}`,u=Object.entries(g).map(([p,f])=>`${p}="${f}"`).join(" ");return`<path d="${i}" ${u}></path>`})}function U(t){return t=k(t),t=V(t),t=B(t),t=L(t),t=D(t),t}function Y(t){let e=["g","defs","metadata","title","desc","marker"];for(let r of e){let s=new RegExp(`<${r}\\b[^>]*>`,"g"),n=new RegExp(`</${r}\\s*>`,"g");t=t.replace(s,""),t=t.replace(n,"")}return t}function W(t){return t.replace(/>\s+</g,"><").replace(/\s+(?==|>)/g,"").replace(/(\r\n|\n|\r|\t)/g,"")}function G(t){return t=W(t),t=Y(t),t.replace(/<(\w+)><\/\1>/g,"").replace(/"/g,"'").replace(/([a-zA-Z-]+)\s*=\s*([a-zA-Z0-9-]+)/g,"$1=$2").replace(/style="([^"]+)"/g,(e,r)=>`style="${r.replace(/(\r\n|\n|\r|\t)/gm,"").replace(/ +/g," ")}"`)}function Q(t){return t=G(t),t=U(t),t}function I(t,e){switch(e){case"best":t=Q(t);break;case"standard":case void 0:t=G(t);break;case"fast":t=W(t);break;default:break}return t}function O(t){return t.length===1?"file":"files"}function Z(){if(b.length>0){console.log(`
\x1B[42m parsed ${S.length} SVG ${O(S)} \x1B[0m`);let t=[`
\x1B[33m(!) Please provide a standard svg ${O(b)}.`,`\x1B[1m${O(b)}:\x1B[22m ${JSON.stringify(b,null,2)}`,`   \x1B[1mNot a valid SVG file.\x1B[22m
`,`\x1B[33m- To remove the warning information, delete or remove the SVG ${O(b)}.`,`- Visit \x1B[4mhttps://developer.mozilla.org/en-US/docs/Web/SVG\x1B[24m know more about SVG.\x1B[0m
`];console.log(`${t.join(`
`)}`)}}function j(t,e){m.stat(t,(r,s)=>{if(r){F.error("Could not read file information:",`${r}`);return}let a=s.size/1024;F.info(`\x1B[2mCompleted in ${C}ms.\x1B[22m`),Z(),F.success(`\x1B[32mgenerated\x1B[0m 'sprite.svg' ${a}(kb).`)})}var _={emitFile:!0},tt={include:"./src/assets/images/sprite",mode:"verbose",emitFile:{compress:"standard",path:"assets/images"},..._},C;function et(t={}){var g,i;let e,r,s={...tt,...t},n=q(t.include),a=H((g=t.emitFile)==null?void 0:g.path),o=N(n),c=I(E(o),(i=s.emitFile)==null?void 0:i.compress);function l(){$(n)&&(t.emitFile||s.emitFile)&&(o.length!==0&&R(e,c),s.mode!=="quiet"&&j(e,a))}return{name:P,hooks:{"astro:config:setup":async({injectScript:u})=>{((t==null?void 0:t.emitFile)!==void 0||(t==null?void 0:t.emitFile)===!1)&&u("page",`document.body.insertAdjacentHTML("beforeend", "${c}")`)},"astro:config:done":async({config:u})=>{r=u,e=`${r.publicDir.pathname}${a}/sprite.svg`},"astro:server:start":async()=>{C=v(l)},"astro:build:start":async()=>{C=v(l)}}}}export{et as default,C as executionTime};
